\documentclass[10pt,a4paper]{article}
\usepackage[english]{babel}
\usepackage{tikz}
\usepackage{forest}
\usepackage{graphicx} 
\usepackage{pdfpages}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{amstext}
\usepackage{scrlayer-scrpage}
\usepackage{titling}
\pagestyle{scrheadings}
\clearpairofpagestyles

\author{Emil Paulitz, Raphael Olipitz}
\title{Sequence Bioinformatics\\Assignment 05}

\tikzset{
	dummy/.style    = {circle,draw}
}

\begin{document}
	\ohead{\theauthor}
	\cfoot{\pagemark}
	\maketitle
	\section*{Task 1}
		Forward Trie:
		\begin{center}
			\begin{tikzpicture}[scale=0.2]
			\tikzstyle{every node}+=[inner sep=0pt]
			\draw [black] (3.8,-26.7) circle (3);
			\draw [black] (17.8,-5.7) circle (3);
			\draw [black] (17.1,-26.7) circle (3);
			\draw [black] (17.1,-47.8) circle (3);
			\draw [black] (29.7,-5.7) circle (3);
			\draw [black] (29.7,-20) circle (3);
			\draw [black] (29.7,-37.3) circle (3);
			\draw [black] (29.7,-47.9) circle (3);
			\draw [black] (42,-5.7) circle (3);
			\draw [black] (54.2,-5.7) circle (3);
			\draw [black] (54.2,-5.7) circle (2.4);
			\draw [black] (42,-14.8) circle (3);
			\draw [black] (42,-37.3) circle (3);
			\draw [black] (42,-26.7) circle (3);
			\draw [black] (54.2,-14.8) circle (3);
			\draw [black] (54.2,-14.8) circle (2.4);
			\draw [black] (54.2,-26.7) circle (3);
			\draw [black] (66.2,-26.7) circle (3);
			\draw [black] (77.9,-26.7) circle (3);
			\draw [black] (77.9,-26.7) circle (2.4);
			\draw [black] (54.2,-37.3) circle (3);
			\draw [black] (66.2,-37.3) circle (3);
			\draw [black] (77.9,-37.3) circle (3);
			\draw [black] (77.9,-37.3) circle (2.4);
			\draw [black] (42,-47.9) circle (3);
			\draw [black] (54.2,-47.9) circle (3);
			\draw [black] (54.2,-47.9) circle (2.4);
			\draw [black] (6.8,-26.7) -- (14.1,-26.7);
			\fill [black] (14.1,-26.7) -- (13.3,-26.2) -- (13.3,-27.2);
			\draw (10.45,-27.2) node [below] {$G$};
			\draw [black] (5.46,-24.2) -- (16.14,-8.2);
			\fill [black] (16.14,-8.2) -- (15.28,-8.58) -- (16.11,-9.14);
			\draw (11.41,-17.53) node [right] {$A$};
			\draw [black] (5.4,-29.24) -- (15.5,-45.26);
			\fill [black] (15.5,-45.26) -- (15.5,-44.32) -- (14.65,-44.85);
			\draw (9.82,-38.55) node [left] {$T$};
			\draw [black] (20.8,-5.7) -- (26.7,-5.7);
			\fill [black] (26.7,-5.7) -- (25.9,-5.2) -- (25.9,-6.2);
			\draw (23.75,-6.2) node [below] {$G$};
			\draw [black] (32.7,-5.7) -- (39,-5.7);
			\fill [black] (39,-5.7) -- (38.2,-5.2) -- (38.2,-6.2);
			\draw (35.85,-6.2) node [below] {$C$};
			\draw [black] (45,-5.7) -- (51.2,-5.7);
			\fill [black] (51.2,-5.7) -- (50.4,-5.2) -- (50.4,-6.2);
			\draw (48.1,-6.2) node [below] {$T$};
			\draw [black] (19.75,-25.29) -- (27.05,-21.41);
			\fill [black] (27.05,-21.41) -- (26.11,-21.34) -- (26.58,-22.23);
			\draw (22.18,-22.85) node [above] {$G$};
			\draw [black] (32.46,-18.83) -- (39.24,-15.97);
			\fill [black] (39.24,-15.97) -- (38.31,-15.82) -- (38.69,-16.74);
			\draw (34.72,-16.88) node [above] {$C$};
			\draw [black] (45,-14.8) -- (51.2,-14.8);
			\fill [black] (51.2,-14.8) -- (50.4,-14.3) -- (50.4,-15.3);
			\draw (48.1,-14.3) node [above] {$C$};
			\draw [black] (32.33,-21.44) -- (39.37,-25.26);
			\fill [black] (39.37,-25.26) -- (38.9,-24.44) -- (38.42,-25.32);
			\draw (34.74,-23.85) node [below] {$T$};
			\draw [black] (19.4,-28.63) -- (27.4,-35.37);
			\fill [black] (27.4,-35.37) -- (27.11,-34.47) -- (26.47,-35.24);
			\draw (22.17,-32.49) node [below] {$A$};
			\draw [black] (32.7,-37.3) -- (39,-37.3);
			\fill [black] (39,-37.3) -- (38.2,-36.8) -- (38.2,-37.8);
			\draw (35.85,-37.8) node [below] {$G$};
			\draw [black] (20.1,-47.82) -- (26.7,-47.88);
			\fill [black] (26.7,-47.88) -- (25.9,-47.37) -- (25.9,-48.37);
			\draw (23.4,-48.36) node [below] {$C$};
			\draw [black] (45,-26.7) -- (51.2,-26.7);
			\fill [black] (51.2,-26.7) -- (50.4,-26.2) -- (50.4,-27.2);
			\draw (48.1,-27.2) node [below] {$A$};
			\draw [black] (57.2,-26.7) -- (63.2,-26.7);
			\fill [black] (63.2,-26.7) -- (62.4,-26.2) -- (62.4,-27.2);
			\draw (60.2,-27.2) node [below] {$C$};
			\draw [black] (69.2,-26.7) -- (74.9,-26.7);
			\fill [black] (74.9,-26.7) -- (74.1,-26.2) -- (74.1,-27.2);
			\draw (72.05,-27.2) node [below] {$C$};
			\draw [black] (45,-37.3) -- (51.2,-37.3);
			\fill [black] (51.2,-37.3) -- (50.4,-36.8) -- (50.4,-37.8);
			\draw (48.1,-37.8) node [below] {$C$};
			\draw [black] (57.2,-37.3) -- (63.2,-37.3);
			\fill [black] (63.2,-37.3) -- (62.4,-36.8) -- (62.4,-37.8);
			\draw (60.2,-37.8) node [below] {$T$};
			\draw [black] (69.2,-37.3) -- (74.9,-37.3);
			\fill [black] (74.9,-37.3) -- (74.1,-36.8) -- (74.1,-37.8);
			\draw (72.05,-37.8) node [below] {$C$};
			\draw [black] (32.7,-47.9) -- (39,-47.9);
			\fill [black] (39,-47.9) -- (38.2,-47.4) -- (38.2,-48.4);
			\draw (35.85,-48.4) node [below] {$G$};
			\draw [black] (45,-47.9) -- (51.2,-47.9);
			\fill [black] (51.2,-47.9) -- (50.4,-47.4) -- (50.4,-48.4);
			\draw (48.1,-48.4) node [below] {$A$};
			\end{tikzpicture}
		\end{center}
		
		\newpage
		Reverse Trie:
		\begin{center}
			\begin{tikzpicture}[scale=0.2]
			\tikzstyle{every node}+=[inner sep=0pt]
			\draw [black] (3.8,-26.7) circle (3);
			\draw [black] (17.8,-5.7) circle (3);
			\draw [black] (17.1,-26.7) circle (3);
			\draw [black] (17.1,-47.8) circle (3);
			\draw [black] (29.7,-5.7) circle (3);
			\draw [black] (29.7,-20) circle (3);
			\draw [black] (29.7,-37.3) circle (3);
			\draw [black] (29.7,-47.9) circle (3);
			\draw [black] (42,-5.7) circle (3);
			\draw [black] (54.2,-5.7) circle (3);
			\draw [black] (54.2,-5.7) circle (2.4);
			\draw [black] (42,-14.8) circle (3);
			\draw [black] (42,-37.3) circle (3);
			\draw [black] (42,-26.7) circle (3);
			\draw [black] (54.2,-14.8) circle (3);
			\draw [black] (54.2,-14.8) circle (2.4);
			\draw [black] (54.2,-26.7) circle (3);
			\draw [black] (66.2,-26.7) circle (3);
			\draw [black] (77.9,-26.7) circle (3);
			\draw [black] (77.9,-26.7) circle (2.4);
			\draw [black] (54.2,-37.3) circle (3);
			\draw [black] (66.2,-37.3) circle (3);
			\draw [black] (77.9,-37.3) circle (3);
			\draw [black] (77.9,-37.3) circle (2.4);
			\draw [black] (42,-47.9) circle (3);
			\draw [black] (54.2,-47.9) circle (3);
			\draw [black] (54.2,-47.9) circle (2.4);
			\draw [black] (6.8,-26.7) -- (14.1,-26.7);
			\fill [black] (14.1,-26.7) -- (13.3,-26.2) -- (13.3,-27.2);
			\draw (10.45,-27.2) node [below] {$C$};
			\draw [black] (5.46,-24.2) -- (16.14,-8.2);
			\fill [black] (16.14,-8.2) -- (15.28,-8.58) -- (16.11,-9.14);
			\draw (11.41,-17.53) node [right] {$T$};
			\draw [black] (5.4,-29.24) -- (15.5,-45.26);
			\fill [black] (15.5,-45.26) -- (15.5,-44.32) -- (14.65,-44.85);
			\draw (9.82,-38.55) node [left] {$A$};
			\draw [black] (20.8,-5.7) -- (26.7,-5.7);
			\fill [black] (26.7,-5.7) -- (25.9,-5.2) -- (25.9,-6.2);
			\draw (23.75,-6.2) node [below] {$C$};
			\draw [black] (32.7,-5.7) -- (39,-5.7);
			\fill [black] (39,-5.7) -- (38.2,-5.2) -- (38.2,-6.2);
			\draw (35.85,-6.2) node [below] {$G$};
			\draw [black] (45,-5.7) -- (51.2,-5.7);
			\fill [black] (51.2,-5.7) -- (50.4,-5.2) -- (50.4,-6.2);
			\draw (48.1,-6.2) node [below] {$A$};
			\draw [black] (19.75,-25.29) -- (27.05,-21.41);
			\fill [black] (27.05,-21.41) -- (26.11,-21.34) -- (26.58,-22.23);
			\draw (22.24,-22.85) node [above] {$C$};
			\draw [black] (32.46,-18.83) -- (39.24,-15.97);
			\fill [black] (39.24,-15.97) -- (38.31,-15.82) -- (38.69,-16.74);
			\draw (34.67,-16.88) node [above] {$G$};
			\draw [black] (45,-14.8) -- (51.2,-14.8);
			\fill [black] (51.2,-14.8) -- (50.4,-14.3) -- (50.4,-15.3);
			\draw (48.1,-14.3) node [above] {$G$};
			\draw [black] (32.33,-21.44) -- (39.37,-25.26);
			\fill [black] (39.37,-25.26) -- (38.9,-24.44) -- (38.42,-25.32);
			\draw (34.63,-23.85) node [below] {$A$};
			\draw [black] (19.4,-28.63) -- (27.4,-35.37);
			\fill [black] (27.4,-35.37) -- (27.11,-34.47) -- (26.47,-35.24);
			\draw (22.28,-32.49) node [below] {$T$};
			\draw [black] (32.7,-37.3) -- (39,-37.3);
			\fill [black] (39,-37.3) -- (38.2,-36.8) -- (38.2,-37.8);
			\draw (35.85,-37.8) node [below] {$C$};
			\draw [black] (20.1,-47.82) -- (26.7,-47.88);
			\fill [black] (26.7,-47.88) -- (25.9,-47.37) -- (25.9,-48.37);
			\draw (23.4,-48.36) node [below] {$G$};
			\draw [black] (45,-26.7) -- (51.2,-26.7);
			\fill [black] (51.2,-26.7) -- (50.4,-26.2) -- (50.4,-27.2);
			\draw (48.1,-27.2) node [below] {$T$};
			\draw [black] (57.2,-26.7) -- (63.2,-26.7);
			\fill [black] (63.2,-26.7) -- (62.4,-26.2) -- (62.4,-27.2);
			\draw (60.2,-27.2) node [below] {$G$};
			\draw [black] (69.2,-26.7) -- (74.9,-26.7);
			\fill [black] (74.9,-26.7) -- (74.1,-26.2) -- (74.1,-27.2);
			\draw (72.05,-27.2) node [below] {$G$};
			\draw [black] (45,-37.3) -- (51.2,-37.3);
			\fill [black] (51.2,-37.3) -- (50.4,-36.8) -- (50.4,-37.8);
			\draw (48.1,-37.8) node [below] {$G$};
			\draw [black] (57.2,-37.3) -- (63.2,-37.3);
			\fill [black] (63.2,-37.3) -- (62.4,-36.8) -- (62.4,-37.8);
			\draw (60.2,-37.8) node [below] {$A$};
			\draw [black] (69.2,-37.3) -- (74.9,-37.3);
			\fill [black] (74.9,-37.3) -- (74.1,-36.8) -- (74.1,-37.8);
			\draw (72.05,-37.8) node [below] {$G$};
			\draw [black] (32.7,-47.9) -- (39,-47.9);
			\fill [black] (39,-47.9) -- (38.2,-47.4) -- (38.2,-48.4);
			\draw (35.85,-48.4) node [below] {$C$};
			\draw [black] (45,-47.9) -- (51.2,-47.9);
			\fill [black] (51.2,-47.9) -- (50.4,-47.4) -- (50.4,-48.4);
			\draw (48.1,-48.4) node [below] {$T$};
			\end{tikzpicture}
		\end{center}
		
		\noindent
		$l_{\text{min}} = 4\\
		d(A) = 2\\
		d(C) = 1\\
		d(G) = 1\\
		d(T) = 1$
		\newpage
	\section*{Task 2}
		\includegraphics[width = \textwidth, trim=2cm 6cm 4cm 1cm,clip]{task2.pdf}
		If the algorithm can check with a single lookup (using keys for example) whether there exists an edge with the desired character, it performs $3+4+1+4+2+4+6+3+4+3 = 34$ letter comparisons. 
	\section*{Task 3}
		One iterates over every suffix, starting with the longest one (the whole word). For every suffix, one starts at the root and tries to match the current suffix with the entries on the existing edges (for the first suffix, no edges exist). If this fails, one starts a new branch at the position in the tree no match was found (for the first suffix, the root), which then ends in a leaf that holds the starting position of the suffix. For "whakapapa", this results in the following suffix tree:\\
%		\begin{forest}
%			[
%				[1, edge label={node [midway,left] {whakapapa\$} }]
%				[2, edge label={node [midway,right] {hakapapa\$}}]
%				[3, grow=east, edge label={node [midway,right] {a\$}}]
%				[4, edge label={node [midway,right] {kapapa\$}}]
%				[, edge label={node [midway,right] {pa\$}}
%					[8,edge label={node [midway,right] {\$}}]
%					[6,edge label={node [midway,right] {pa\$}}]]
%				[10, edge label={node [midway,right] {\$}}]]
%		\end{forest}
	\begin{tikzpicture}
		[
		grow                    = down,
		sibling distance        = 6em,
		level distance          = 10em,
		edge from parent/.style = {draw, -latex},
		every node/.style       = {font=\footnotesize},
		sloped
		]
		\node [dummy] {}
		child { node [dummy] {1}
			edge from parent node [below] {whakapapa\$} }
		child { node [dummy] {2}
			edge from parent node [below] {hakapapa\$} }
		child { node [dummy] {}
			child { node [dummy] {3}
				edge from parent node [below] {kapapa\$} }
			child { node [dummy] {}
				child { node [dummy] {5}
					edge from parent node [below] {pa\$} }
				child { node [dummy] {7}
					edge from parent node [below] {\$}}
				edge from parent node [below] {pa}}
			child { node [dummy] {9}
				edge from parent node [below] {\$} }
			edge from parent node [below] {a} }
		child { node [dummy] {4}
			edge from parent node [below] {kapapa\$} }
		child { node [dummy] {}
				child { node [dummy] {8}
					edge from parent node [below] {\$} }
			child { node [dummy] {6}
				edge from parent node [below] {pa\$} }
			edge from parent node [below] {pa} }
		child { node [dummy] {10}
			edge from parent node [below] {\$} };
	\end{tikzpicture}
	\section*{Task 4}
		To find all occurrences of the search query 'pa', one would start from the root and\\
		1. compare the first letter on every outgoing node with the first letter of the query. In this case, one would search for an outgoing branch that has a label beginning with 'p'.\\
		2. If one is found, the other letters are compared with the branch's label, in our case 'a' matches.\\
		3. Because the query is finished, one follows every path to a leaf and reports the starting point of this suffix, recorded at the leaf: 7 and 5.

\end{document}






